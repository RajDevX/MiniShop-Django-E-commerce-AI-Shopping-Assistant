{% extends "home/base.html" %}
{% load static %} 
{% block title %}Shop{%endblock%} 
{% block content %}

<div
  class="hero-wrap hero-bread"
  style="background-image: url('{% static "home/images/bg_6.jpg" %}')"
>
  <div class="container">
    <div
      class="row no-gutters slider-text align-items-center justify-content-center"
    >
      <div class="col-md-9 ftco-animate text-center">
        <p class="breadcrumbs">
          <span class="mr-2"><a href="{% url 'home' %}">Home</a></span>
          <span>Shop</span>
        </p>
        <h1 class="mb-0 bread">Shop</h1>
      </div>
    </div>
  </div>
</div>

<section class="ftco-section bg-light">
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-lg-10 order-md-last">
        <div class="row">
          {% if products %}
            {% for product in products %}
              <div id="product-{{ product.id }}" class="col-sm-12 col-md-6 col-lg-4 ftco-animate d-flex mb-4">
                {% if highlight_product_id == product.id %}
                  {% include "home/components/product_card.html" with product=product extra_card_classes="border border-primary" %}
                {% else %}
                  {% include "home/components/product_card.html" with product=product %}
                {% endif %}
              </div>
            {% endfor %}
          {% else %}
            <div class="alert alert-info text-center" role="alert">
              <strong>No Products Found</strong>  
            </div>
          {% endif %}
        </div>
        <div class="row mt-5">
          <div class="col text-center">
            <div class="block-27">
              <ul>
                  <!-- Previous Button -->
                  {% if products.has_previous %}
                      <li><a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ products.previous_page_number }}">&lt;</a></li>
                  {% else %}
                      <li class="disabled"><span>&lt;</span></li>
                  {% endif %}


                  <!-- Show Only 5 Pages -->
                  {% for num in products.paginator.page_range %}
                      {% if num >= products.number|add:'-2' and num <= products.number|add:'2' %}
                          {% if products.number == num %}
                              <li class="active"><span>{{ num }}</span></li>
                          {% else %}
                              <li><a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ num }}">{{ num }}</a></li>
                          {% endif %}
                      {% endif %}
                  {% endfor %}

                  <!-- Next Button -->
                  {% if products.has_next %}
                      <li><a href="?{% if querystring %}{{ querystring }}&{% endif %}page={{ products.next_page_number }}">&gt;</a></li>
                  {% else %}
                      <li class="disabled"><span>&gt;</span></li>
                  {% endif %}
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4 col-lg-2">
        <div class="sidebar">
          <div class="sidebar-box-2">
            <h2 class="heading">Categories</h2>
            <div class="fancy-collapse-panel">
              <div
                class="panel-group"
                id="accordion"
                role="tablist"
                aria-multiselectable="true"
              >
              {% if category_data %}
                {% for cat in category_data %}
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="heading{{cat.id}}">
                      <h4 class="panel-title">
                        <a
                          class="collapsed"
                          data-toggle="collapse"
                          data-parent="#accordion"
                          href="#collapse{{cat.id}}"
                          aria-expanded="false"
                          aria-controls="collapse{{cat.id}}"
                          >{{cat.name | default:"No Name"}}
                        </a>
                      </h4>
                    </div>
                    <div
                      id="collapse{{cat.id}}"
                      class="panel-collapse collapse"
                      role="tabpanel"
                      aria-labelledby="heading{{cat.id}}">
                      <div class="panel-body">
                        <ul>
                          {% for sub_cat in cat.sub_categories %}
                            <li><a  href="{% url 'category_products' sub_cat.slug %}">{{sub_cat.name}}</a></li>
                          {% endfor %}
                        </ul>
                      </div>
                    </div>
                  </div>
                {% endfor %}
              {% else %}
                <div class="alert alert-info text-center" role="alert">
                  <strong>No Data Found</strong>
                </div>
              {% endif %}
                
              </div>
            </div>
          </div>
          <div class="sidebar-box-2">
            <h2 class="heading">Price Range</h2>
            <form method="get" class="colorlib-form-2">
              {% if request.GET.highlight %}
                <input type="hidden" name="highlight" value="{{ request.GET.highlight }}">
              {% endif %}
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label for="min_price">Price from</label>
                    <input
                      type="number"
                      inputmode="decimal"
                      class="form-control"
                      id="min_price"
                      name="min_price"
                      min="0"
                      step="1"
                      placeholder="0"
                      value="{{ request.GET.min_price }}"
                    />
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-group">
                    <label for="max_price">Price to</label>
                    <input
                      type="number"
                      inputmode="decimal"
                      class="form-control"
                      id="max_price"
                      name="max_price"
                      min="0"
                      step="1"
                      placeholder="5000"
                      value="{{ request.GET.max_price }}"
                    />
                  </div>
                </div>
                <div class="col-md-12">
                  <button type="submit" class="btn btn-primary btn-block">Apply</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
