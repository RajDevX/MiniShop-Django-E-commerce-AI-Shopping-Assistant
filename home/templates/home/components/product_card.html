{% load static %}

<div class="card w-100 product-card {{ extra_card_classes|default:'' }}">
  <div class="product-card__media">
    <a href="{% url 'product_detail' product.id %}">
      {% if product.image %}
        <img class="card-img-top product-card__img" src="{{ product.image.url }}" alt="{{ product.name }}" />
      {% else %}
        <img class="card-img-top product-card__img" src="{% static 'home/images/bg_1.jpg' %}" alt="{{ product.name }}" />
      {% endif %}
    </a>

    {% if request.user.is_authenticated %}
      {% if liked_product_ids and product.id in liked_product_ids %}
        <button
          type="button"
          class="product-card__like js-like-toggle"
          aria-label="Unlike {{ product.name }}"
          aria-pressed="true"
          data-like-url="{% url 'toggle_like' product.id %}"
        >
          <span class="ion-ios-heart"></span>
        </button>
      {% else %}
        <button
          type="button"
          class="product-card__like js-like-toggle"
          aria-label="Like {{ product.name }}"
          aria-pressed="false"
          data-like-url="{% url 'toggle_like' product.id %}"
        >
          <span class="ion-ios-heart-empty"></span>
        </button>
      {% endif %}
    {% else %}
      <a
        class="product-card__like"
        aria-label="Login to like {{ product.name }}"
        href="{% url 'login' %}?next={{ request.get_full_path|urlencode }}"
      >
        <span class="ion-ios-heart-empty"></span>
      </a>
    {% endif %}
  </div>
  <div class="card-body d-flex flex-column">
    <small class="text-muted text-uppercase mb-2 product-card__meta">
      {% if product.category %}{{ product.category.name }}{% endif %}
    </small>
    <h5 class="card-title mb-2">{{ product.name }}</h5>
    <p class="card-text mb-4">${{ product.price }}</p>
    <div class="mt-auto d-flex product-card__actions">
      <a href="{% url 'add_product_to_cart' product.id %}" class="btn btn-primary mr-2">
        Add <i class="ion-ios-add ml-1"></i>
      </a>
      <a href="{% url 'product_detail' product.id %}" class="btn btn-outline-primary">
        View <i class="ion-ios-eye ml-1"></i>
      </a>
    </div>
  </div>
</div>
